TARGET_FOLDER=@PLATFORM_ID@
CC=@PLATFORM_PREFIX@gcc
LD=arch/$(TARGET_FOLDER)/linker.ld
LDARGS=@PLATFORM_AFLAGS@
OBJ = $(wildcard *.o)

.PHONY: all
all: LiquiDOS.bin

# Link 'em all up
LiquiDOS.bin: $(OBJ)
	@echo "\n\033[1;36m[Linking object files]\033[0m"
	@$(CC) -T $(LD) -o $@ $^ $(LDARGS)
	@mv LiquiDOS.bin ../bin
ifeq ($(TARGET_FOLDER),raspi)
	@arm-none-eabi-objcopy ../bin/LiquiDOS.bin -O binary ../bin/kernel.img
endif
	@echo "\033[1;32mBinary file produced!\033[0m\n"